
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="Johannes Delport">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.0">
    
    
      
        <title>Component Stamps - JoSIM v2.5 Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d877a71.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.17bd0b03.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="black" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#component-stamps" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="JoSIM v2.5 Documentation" class="md-header-nav__button md-logo" aria-label="JoSIM v2.5 Documentation">
      
  <img src="../img/favicon.ico" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            JoSIM v2.5 Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Component Stamps
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/JoeyDelp/JoSIM" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    JoeyDelp/JoSIM
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="JoSIM v2.5 Documentation" class="md-nav__button md-logo" aria-label="JoSIM v2.5 Documentation">
      
  <img src="../img/favicon.ico" alt="logo">

    </a>
    JoSIM v2.5 Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/JoeyDelp/JoSIM" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    JoeyDelp/JoSIM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../tech_disc/" title="Technical Discussion" class="md-nav__link">
      Technical Discussion
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ex_usage/" title="Example Usage" class="md-nav__link">
      Example Usage
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Component Stamps
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Component Stamps" class="md-nav__link md-nav__link--active">
      Component Stamps
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resistor" class="md-nav__link">
    Resistor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inductor" class="md-nav__link">
    Inductor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#josephson-junction" class="md-nav__link">
    Josephson Junction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voltage-source" class="md-nav__link">
    Voltage Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-source" class="md-nav__link">
    Current Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-source" class="md-nav__link">
    Phase Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transmission-line" class="md-nav__link">
    Transmission Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mutual-inductance" class="md-nav__link">
    Mutual inductance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-controlled-current-source" class="md-nav__link">
    Current Controlled Current Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-controlled-voltage-source" class="md-nav__link">
    Current Controlled Voltage Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voltage-controlled-current-source" class="md-nav__link">
    Voltage Controlled Current Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voltage-controlled-voltage-source" class="md-nav__link">
    Voltage Controlled Voltage Source
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../syntax/" title="Syntax Guide" class="md-nav__link">
      Syntax Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../bugs/" title="Development Schedule and Bugs" class="md-nav__link">
      Development Schedule and Bugs
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resistor" class="md-nav__link">
    Resistor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inductor" class="md-nav__link">
    Inductor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#josephson-junction" class="md-nav__link">
    Josephson Junction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voltage-source" class="md-nav__link">
    Voltage Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-source" class="md-nav__link">
    Current Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phase-source" class="md-nav__link">
    Phase Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transmission-line" class="md-nav__link">
    Transmission Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mutual-inductance" class="md-nav__link">
    Mutual inductance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-controlled-current-source" class="md-nav__link">
    Current Controlled Current Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-controlled-voltage-source" class="md-nav__link">
    Current Controlled Voltage Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voltage-controlled-current-source" class="md-nav__link">
    Voltage Controlled Current Source
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#voltage-controlled-voltage-source" class="md-nav__link">
    Voltage Controlled Voltage Source
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="component-stamps">Component Stamps</h1>
<p>In this section we will explore each of the available component stamps found in JoSIM. This will serve as insight into how BDF2 method is applied to produce time dependent voltage or phase equations for each component.</p>
<p>This will serve as a continuation of what was shown in the <a href="../tech_disc/">Technical Discussion</a> section for the Capacitor.</p>
<h3 id="resistor">Resistor</h3>
<p><center><img src="../img/josim_resistor.svg" alt="Basic Resistor Element" style="width:400px;" /></center></p>
<p>A resistor is a passive circuit element for which the voltage dependent equation is defined through Ohm's law:</p>
<div class="arithmatex">\[
v(t) = i_{R_{1}}(t) R_{1}
\]</div>
<div class="arithmatex">\[
V_{n}-R_{1}I_{R_{1}} = 0
\]</div>
<p>This can then be written as a matrix stamp in the form</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp; -R_{1}
\end{bmatrix}
\begin{bmatrix}
V^{+} \\
V^{-}\\
I_{R_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0\\
0 
\end{bmatrix}
\]</div>
<p>If we expand this using the voltage-phase relation shown in <a href="../tech_disc/">Technical Discussion</a>, then we can rewrite the equation as:</p>
<div class="arithmatex">\[
\frac{\Phi_{0}}{2\pi}\frac{d\phi}{dt}_{n}\frac{1}{R_{1}} = I_{R_{1}}
\]</div>
<p>This equation will now require the application of the BDF2 method:</p>
<div class="arithmatex">\[
\frac{\Phi_{0}}{2\pi R_{1}}\frac{3}{2h}\left[\phi_n - \frac{4}{3}\phi_{n-1} + \frac{1}{3}\phi_{n−2}\right] = {I_{R_{1}}}
\]</div>
<div class="arithmatex">\[
\phi_n - \frac{2\pi R_{1}}{\Phi_0}\frac{2h}{3}I_{R_{1}} =\frac{4}{3}\phi_{n-1} - \frac{1}{3}\phi_{n−2}
\]</div>
<p>This allows us to create a phase resistor matrix stamp as:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\ 
1 &amp; -1 &amp;  - \frac{2\pi R_{1}}{\Phi_0}\frac{2h}{3}
\end{bmatrix}
\begin{bmatrix}
\phi_{1} \\
\phi_{2} \\ I_{R_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0 \\  
\frac{4}{3}\phi_{n-1} - \frac{1}{3}\phi_{n−2}
\end{bmatrix}
\]</div>
<h3 id="inductor">Inductor</h3>
<p><center><img src="../img/josim_inductor.svg" alt="Basic Inductor Element" style="width:400px;" /></center></p>
<p>A inductor is defined in terms of voltage and current as:</p>
<div class="arithmatex">\[
v(t)=L_{1}\frac{di}{dt}
\]</div>
<p>This is a first order differential and needs to be expanded using the BDF2 method:</p>
<div class="arithmatex">\[
V_{n} = \frac{3L_{1}}{2h}\left[I_{n}-\frac{4}{3}I_{n-1}+\frac{1}{3}I_{n-2}\right]
\]</div>
<div class="arithmatex">\[
V_{n}-\frac{3L_{1}}{2h}I_{n}=-\frac{2L_{1}}{h}I_{n-1}+\frac{L_{1}}{2h}I_{n-2}
\]</div>
<p>This allows us to create the inductor stamp as:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp;  -\frac{3L_{1}}{2h}
\end{bmatrix}
\begin{bmatrix}
V^{+} \\
V^{-} \\
I_{L_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
-\frac{2L_{1}}{h}I_{n-1}+\frac{L_{1}}{2h}I_{n-2}
\end{bmatrix}
\]</div>
<p>The MNPA stamp for the inductor is derived by substituting the voltage-phase relation.</p>
<div class="arithmatex">\[
\frac{\Phi_{0}}{2\pi}\frac{d\phi}{dt}=L_{1}\frac{di}{dt}
\]</div>
<p>With derivatives on both sides, we can integrate with respect to time on both sides:</p>
<div class="arithmatex">\[
\int\frac{\Phi_{0}}{2\pi}\frac{d\phi}{dt}=\int L_{1}\frac{di}{dt}
\]</div>
<div class="arithmatex">\[
\frac{\Phi_{0}}{2\pi}\phi_{n}=L_{1}I_{n}
\]</div>
<div class="arithmatex">\[
\phi_{n} - \frac{2\pi}{\Phi_{0}}L_{1}I_{n} = 0
\]</div>
<p>Which leads to the extremely simplistic inductor MNPA stamp matrix:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\ 
1 &amp; -1 &amp;  - \frac{2\pi}{\Phi_{0}}L_{1}
\end{bmatrix}
\begin{bmatrix}
\phi^{+} \\
\phi^{-} \\ 
I_{L_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0 \\ 
0
\end{bmatrix}
\]</div>
<h3 id="josephson-junction">Josephson Junction</h3>
<p><center><img src="../img/josim_jj.svg" alt="Basic JJ Element" style="width:400px;" /></center></p>
<p>The Josephson junction above is a simplification of the resistively and capacitively shunted junction (RCSJ) model implemented in JoSIM. This model sums the current through the 3 parallel branches and is represented by the following equation:</p>
<div class="arithmatex">\[
I_{B_{1}} = I_c \sin{\phi} + \frac{V_{n}}{R_{B_{1}}} + C_{B_{1}}\frac{dV_{n}}{dt}
\]</div>
<p>Which when expanded with the BDF2 method becomes:</p>
<div class="arithmatex">\[
I_{B_{1}} = I_{c}\sin\phi+\frac{V_{n}}{R_{B_{1}}}+\frac{3C_{B_{1}}}{2h}\left[V_{n}-\frac{4}{3}V_{n-1}+\frac{1}{3}V_{n-2}\right]
\]</div>
<div class="arithmatex">\[
\frac{V_{n}}{R_{B_{1}}}+ \frac{3C_{B_{1}}}{2h}V_{n} - I_{B_{1}} = -I_{c}\sin\phi+\frac{3C_{B_{1}}}{2h}\frac{4}{3}V_{n-1}-\frac{3C_{B_{1}}}{2h}\frac{1}{3}V_{n-2}
\]</div>
<div class="arithmatex">\[
V_{n}-\frac{2hR_{B_{1}}}{2h+3C_{B_{1}}R_{B_{1}}}I_{B_{1}}=\frac{2hR_{B_{1}}}{2h+3C_{B_{1}}R_{B_{1}}}\left[I_{c}\sin\phi-\frac{2C_{B_{1}}}{h}V_{n-1}+\frac{C_{B_{1}}}{2h}V_{n-2}\right]
\]</div>
<p>This equation depends on the phase at the present time step, which needs to be solved. Phase is not, however, solved and we therefore need to use the voltage-phase relationship to find a voltage dependent solution for the phase:</p>
<div class="arithmatex">\[
V_{n} = \frac{\Phi_0}{2\pi}{\frac{d\phi}{dt}}_{n}
\]</div>
<div class="arithmatex">\[
V_{n} = \frac{\Phi_{0}}{2\pi}\frac{3}{2h}\left[\phi_{n}-\frac{4}{3}\phi_{n-1}+\frac{1}{3}\phi_{n-2}\right]
\]</div>
<div class="arithmatex">\[
V_{n}-\frac{\Phi_{0}}{2\pi}\frac{3}{2h}\phi_n=-\frac{\Phi_{0}}{2\pi}\frac{2}{h}\phi_{n-1}+\frac{\Phi_{0}}{2\pi}\frac{1}{h}\phi_{n-2}
\]</div>
<p>We can now combine these two equations to form the component stamp matrix:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp; -\frac{\Phi_{0}}{2\pi}\frac{3}{2h} &amp; 0 \\ 
1 &amp; -1 &amp; 0 &amp; -\frac{2hR_{B_{1}}}{2h+3C_{B_{1}}R_{B_{1}}}
\end{bmatrix}
\begin{bmatrix}
V^{+} \\
V^{-} \\ 
\phi_{n}\\
I_{B_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
-\frac{\Phi_{0}}{2\pi}\frac{2}{h}\phi_{n-1}+\frac{\Phi_{0}}{2\pi}\frac{1}{h}\phi_{n-2} \\
I_{s} 
\end{bmatrix}
\]</div>
<p>Where <span class="arithmatex">\(I_{s} = \frac{2hR_{B_{1}}}{2h+3C_{B_{1}}R_{B_{1}}}\left[I_{c}\sin\phi-\frac{2C_{B_{1}}}{h}V_{n-1}+\frac{C_{B_{1}}}{2h}V_{n-2}\right]\)</span></p>
<p>It is, however, not possible to use the phase value for the current time step in the calculation of the current time step, we therefore have to rely on an estimated phase value based on previous values.</p>
<p>We define this estimation as:</p>
<div class="arithmatex">\[
\phi_{n}^{0} =\frac{4}{3}\phi_{n-1}-\frac{1}{3}\phi_{n-2}+ \frac{2\pi}{\Phi_{0}}\frac{2h}{3}V_{n}^{0}
\]</div>
<div class="arithmatex">\[
V_{n}^{0} = V_{n-1} + h\frac{dV}{dt}_{n-1}
\]</div>
<div class="arithmatex">\[
V_{n}^{0}=V_{n-1}+\frac{3}{2}V_{n-1}-2V_{n-2}+\frac{1}{2}V_{n-3}
\]</div>
<div class="arithmatex">\[
V_{n}^{0}=\frac{5}{2}V_{n-1}-2V_{n-2}+\frac{1}{2}V_{n-3}
\]</div>
<p>The current phase case is rather basic and we therefore replace the supercurrent term with the more general term defined by Haberkorn<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>:</p>
<div class="arithmatex">\[
I_c\sin\phi = \frac{\pi\Delta}{2eR_N}\frac{\sin{\phi}}{\sqrt{1 - \overline{D}\sin^2\left(\frac{\phi}{2}\right)}}\tanh\left[\frac{\Delta}{2k_BT}\sqrt{1-\overline{D}\sin^2\left(\frac{\phi}{2}\right)}\right]
\]</div>
<p>This equation introduces temperature dependence within the junction model through <span class="arithmatex">\(\Delta\)</span>:</p>
<div class="arithmatex">\[
\Delta_0 = 1.76k_BT_c​
\]</div>
<div class="arithmatex">\[
\Delta = \Delta_0\sqrt{\cos\left[\frac{\pi}{2}\left(\frac{T}{T_c}\right)^2\right]}
\]</div>
<p>with <span class="arithmatex">\(T\)</span>, the boiling point of liquid Helium (4.2K), <span class="arithmatex">\(T_{c}\)</span> the critical temperature of Niobium (9.1K) and <span class="arithmatex">\(k_{B}\)</span> is Boltzmann's constant for average kinetic energy of particles.</p>
<p>The resistance value <span class="arithmatex">\(R_{N}\)</span> is defined as:</p>
<div class="arithmatex">\[
R_N = \frac{\pi\Delta}{2eI_c}\tanh\left(\frac{\Delta}{2k_{B}T}\right)
\]</div>
<p>This allows us to change the characteristics of the tunnel current by simply altering the transparency value <span class="arithmatex">\(\overline{D}\)</span>. For values of <span class="arithmatex">\(\overline{D} \ll 1\)</span> the equation becomes the normal sinusoidal equation whereas for large values of <span class="arithmatex">\(\overline{D}\)</span> it becomes the non-sinusoidal ballistic tunneling equation.</p>
<p>To define the Josephson junction in phase we simply swap the voltage and phase of the component previously identified. The equations remain mostly the same since the Josephson junction is already a phase element.</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp; -\frac{2\pi}{\Phi_{0}}\frac{2h}{3} &amp; 0 \\ 
0 &amp; 0 &amp; 1 &amp; -\frac{2hR_{B_{1}}}{2h+3C_{B_{1}}R_{B_{1}}} 
\end{bmatrix}
\begin{bmatrix}
\phi^{+} \\
\phi^{-} \\ 
V_{n}\\
I_{B_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
\frac{4}{3}\phi_{n-1} - \frac{1}{3}\phi_{n-2} \\
I_{s} 
\end{bmatrix}
\]</div>
<h3 id="voltage-source">Voltage Source</h3>
<p><center><img src="../img/josim_vs.svg" alt="Basic Voltage Source Element" style="Width:400px;" /></center></p>
<p>A voltage source is nothing more than is implied. It is a source of voltage, this indicates that the voltage at any time step is known. We can therefore easily create a component stamp matrix in the form:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\ 
1 &amp; -1 &amp; 0  
\end{bmatrix}
\begin{bmatrix}
V^{+} \\
V^{-} \\ 
I_{V_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0 \\ 
V_{1}
\end{bmatrix}
\]</div>
<p>The phase version of this element simply sees the voltage replaced with the voltage-phase relation:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\ 
1 &amp; -1 &amp; 0  
\end{bmatrix}
\begin{bmatrix}
\phi_{+} \\
\phi_{-} \\ 
I_{V_{1}}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0 \\ 
\frac{4}{3}\phi_{n-1}-\frac{1}{3}\phi_{n-2}+ \frac{2\pi}{\Phi_{0}}\frac{2h}{3}V_{n}
\end{bmatrix}
\]</div>
<h3 id="current-source">Current Source</h3>
<p><center><img src="../img/josim_cs.svg" alt="Basic Current Source Element" style="width:400px;" /></center></p>
<p>A current source is, as implied, a current that is known at every time step in the simulation. It can therefore simply be applied where needed on the RHS.</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0  \\
0 &amp; 0   
\end{bmatrix}
\begin{bmatrix}
V^{+} \\
V^{-}
\end{bmatrix}
=
\begin{bmatrix}
-I_{1}\\
I_{1}
\end{bmatrix}
\]</div>
<h3 id="phase-source">Phase Source</h3>
<p>Like a voltage source, simply applies a phase where needed within the circuit.</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\ 
1 &amp; -1 &amp; 0  
\end{bmatrix}
\begin{bmatrix}
\phi^{+} \\
\phi^{-} \\ 
I_{\phi}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0 \\ 
\phi_{n}
\end{bmatrix}
\]</div>
<p>When voltage mode is used for analysis, this device transforms into a voltage source with the following stamp:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; -1 \\ 
1 &amp; -1 &amp; 0  
\end{bmatrix}
\begin{bmatrix}
V^{+} \\
V^{-} \\ 
I_{\phi}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0 \\ 
\frac{\Phi_{0}}{2\pi}\frac{3}{2h}\left[\phi_{n}-\frac{4}{3}\phi_{n-1}+\frac{1}{3}\phi_{n-2}\right]
\end{bmatrix}
\]</div>
<h3 id="transmission-line">Transmission Line</h3>
<p><center><img src="../img/josim_tx.svg" alt="Basic Ideal Transmission Line Element" style="width:400px" /></center></p>
<p>A transmission line is, at present, simply a delay element where the delay (<span class="arithmatex">\(T_{D}\)</span>) and impedance (<span class="arithmatex">\(Z_{0}\)</span>) define the length of the transmission line.</p>
<p>At present we model the transmission line as an ideal element without any losses. We will in future implement a more accurate model of the transmission line.</p>
<p>The equations that govern this lossless transmission line are:</p>
<div class="arithmatex">\[
V_1(t) = Z_{0}I_{T_{1}} + Z_{0}I_{T_{2}}(t − T_{D}) + V_2(t − T_{D})
\]</div>
<div class="arithmatex">\[
V_2(t) = Z_{0}I_{T_{2}} + Z_{0}I_{T_{1}}(t − T_{D}) + V_1(t − T_{D})
\]</div>
<p>which leads to</p>
<div class="arithmatex">\[
(V_{1})_{n} - Z_{0}(I_{T_{1}})_{n} = Z_{0}(I_{T_{2}})_{n-k} + (V_{2})_{n-k}
\]</div>
<div class="arithmatex">\[
(V_{2})_{n} - Z_{0}(I_{T_{2}})_{n} = Z_{0}(I_{T_{1}})_{n-k} + (V_{1})_{n-k}
\]</div>
<p>where</p>
<div class="arithmatex">\[
k=\frac{T_D}{h}
\]</div>
<p>Which allows us to create a component stamp matrix</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp; 0 &amp; 0 &amp; -Z_{0} &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; -1 &amp; 0 &amp; -Z_{0}
\end{bmatrix}
\begin{bmatrix}
V_{1}^{+} \\
V_{1}^{-} \\
V_{2}^{+} \\
V_{2}^{-} \\
I_{T_{1}} \\
I_{T_{2}} \\
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
Z_{0}(I_{T_{2}})_{n-k} + (V_{2})_{n-k} \\
Z_{0}(I_{T_{1}})_{n-k} + (V_{1})_{n-k}
\end{bmatrix}
\]</div>
<p>We only expand the first equation of the transmission line in phase for simplicity:</p>
<div class="arithmatex">\[
\frac{\Phi_{0}}{2\pi}\frac{d\phi_{1}}{dt} = Z_{0}(I_{T_{1}})_{n} + Z_{0}(I_{T_{2}})_{n-k} + \frac{\Phi_{0}}{2\pi}\frac{d\phi_2}{dt}_{n-k}
\]</div>
<div class="arithmatex">\[
\frac{\Phi_{0}}{2\pi}\left[\frac{3}{2h}(\phi_{1})_{n} - \frac{2}{h}(\phi_{1})_{n-1} + \frac{1}{2h}{\phi_{1}}_{n-2}\right] = Z_{0}(I_{T_{1}})_{n} + Z_{0}(I_{T_{2}})_{n-k} + \frac{\Phi_{0}}{2\pi}\left[\frac{3}{2h}(\phi_{2})_{n-k} - \frac{2}{h}(\phi_{2})_{n-k-1} + \frac{1}{2h}(\phi_{2})_{n-k-2}\right]
\]</div>
<div class="arithmatex">\[
\frac{3}{2h}(\phi_{1})_{n} - \frac{2}{h}(\phi_{1})_{n-1} + \frac{1}{2h}(\phi_{1})_{n-2} = \frac{2\pi}{\Phi_{0}}Z_{0}(I_{T_{1}})_{n} + \frac{2\pi}{\Phi_{0}}Z_{0}(I_{T_{2}})_{n-k} + \frac{3}{2h}(\phi_{2})_{n-k} - \frac{2}{h}(\phi_{2})_{n-k-1} + \frac{1}{2h}(\phi_{2})_{n-k-2}
\]</div>
<div class="arithmatex">\[
(\phi_{1})_{n} - \frac{2h}{3}\frac{2}{h}(\phi_{1})_{n-1} + \frac{2h}{3}\frac{1}{2h}(\phi_{1})_{n-2} = \frac{2h}{3}\frac{2\pi}{\Phi_{0}}Z_{0}(I_{T_{1}})_{n} + \frac{2h}{3}\frac{2\pi}{\Phi_{0}}Z_{0}(I_{T_{2}})_{n-k} + \frac{2h}{3}\frac{3}{2h}(\phi_{2})_{n-k} - \frac{2h}{3}\frac{2}{h}(\phi_{2})_{n-k-1} + \frac{2h}{3}\frac{1}{2h}(\phi_{2})_{n-k-2}
\]</div>
<div class="arithmatex">\[
(\phi_{1})_{n} - \frac{4}{3}(\phi_{1})_{n-1} + \frac{1}{3}(\phi_{1})_{n-2} = \frac{2\pi}{\Phi_{0}}\frac{2h}{3}Z_{0}(I_{T_{1}})_{n} + \frac{2\pi}{\Phi_{0}}\frac{2h}{3}Z_{0}(I_{T_{2}})_{n-k} + (\phi_{2})_{n-k} - \frac{4}{3}(\phi_{2})_{n-k-1} + \frac{1}{3}(\phi_{2})_{n-k-2} \\
\]</div>
<p>Simplifying this equation results in:</p>
<div class="arithmatex">\[
(\phi_{1})_n - Z_{0}\frac{2\pi}{\Phi_{0}}\frac{2h}{3}(I_{T_{1}})_{n} = Z_{0}\frac{2\pi}{\Phi_{0}}\frac{2h}{3}{I_{T_{2}}}_{n-k} + \frac{4}{3}(\phi_{1})_{n-1} - \frac{1}{3}(\phi_{1})_{n-2} + (\phi_{2})_{n-k} - \frac{4}{3}(\phi_{2})_{n-k-1} + \frac{1}{3}(\phi_{2})_{n-k-2}
\]</div>
<div class="arithmatex">\[
(\phi_{2})_n - Z_{0}\frac{2\pi}{\Phi_{0}}\frac{2h}{3}(I_{T_{2}})_{n} = Z_{0}\frac{2\pi}{\Phi_{0}}\frac{2h}{3}{I_{T_{1}}}_{n-k} + \frac{4}{3}(\phi_{2})_{n-1} - \frac{1}{3}(\phi_{2})_{n-2} + (\phi_{1})_{n-k} - \frac{4}{3}(\phi_{1})_{n-k-1} + \frac{1}{3}(\phi_{1})_{n-k-2}
\]</div>
<p>This leads to the component stamp matrix:</p>
<div class="arithmatex">\[
\begin{bmatrix}
        0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
        0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\ 
        0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 
        0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 \\ 
        1 &amp; -1 &amp; 0 &amp; 0 &amp; - Z_{0}\frac{2\pi}{\Phi_{0}}\frac{2h}{3} &amp; 0 
        \\ 0 &amp; 0 &amp; 1 &amp; -1 &amp; 0 &amp; - Z_{0}\frac{2\pi}{\Phi_{0}}\frac{2h}{3}    
        \end{bmatrix}
    \begin{bmatrix}
        \phi_{1}^{+} \\
        \phi_{1}^{-} \\
        \phi_{2}^{+} \\ 
        \phi_{2}^{-} \\ 
        I_{T_{1}} \\ 
        I_{T_{2}}   
        \end{bmatrix}
    =
    \begin{bmatrix}
        0\\
        0 \\ 
        0 \\ 
        0 \\ 
        V_{T_{1}} \\ 
        V_{T_{2}}
    \end{bmatrix}
\]</div>
<p>With <span class="arithmatex">\(V_{T_{1}}\)</span> and <span class="arithmatex">\(V_{T_{2}}\)</span> the RHS of the expanded equations above.</p>
<h3 id="mutual-inductance">Mutual inductance</h3>
<p><center><img src="../img/josim_mutual.svg" alt="Basic Mutual Inductance Element" style="width:400px;" /></center></p>
<p>Mutual inductance allows simulation of coupling between inductors. This coupling adds an additional term to the inductor equation:</p>
<div class="arithmatex">\[
v_{L_{1}}(t) = L1 \frac{di_{1}(t)}{dt} + M\frac{di_{2}(t)}{dt}
\]</div>
<div class="arithmatex">\[
v_{L_{2}}(t) = L2 \frac{di_{2}(t)}{dt} + M\frac{di_{1}(t)}{dt}
\]</div>
<p>with </p>
<div class="arithmatex">\[
M = k\sqrt{L_{1} L_{2}}
\]</div>
<p>We expand these equations to:</p>
<div class="arithmatex">\[
\left(V_{L_{1}}\right)_n - \frac{3L_{1}}{2h}\left(I_{L_{1}}\right)_n - \frac{3M}{2h}\left(I_{L_{2}}\right)_n =  - \frac{2L_{1}}{h}\left(I_{L_{1}}\right)_{n-1} + \frac{L_{1}}{2h}\left(I_{L_{1}}\right)_{n-2}  - \frac{2M}{h}\left(I_{L_{2}}\right)_{n-1} + \frac{M}{2h}\left(I_{L_{2}}\right)_{n-2}
\]</div>
<div class="arithmatex">\[
\left(V_{L_{2}}\right)_n - \frac{3L_{2}}{2h}\left(I_{L_{2}}\right)_n - \frac{3M}{2h}\left(I_{L_{1}}\right)_n =  - \frac{2L_{2}}{h}\left(I_{L_{2}}\right)_{n-1} + \frac{L_{2}}{2h}\left(I_{L_{2}}\right)_{n-2}  - \frac{2M}{h}\left(I_{L_{1}}\right)_{n-1} + \frac{M}{2h}\left(I_{L_{1}}\right)_{n-2}
\]</div>
<p>This leads to the component stamp matrix:</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\       
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp; 0 &amp; 0 &amp; - \frac{3L_{1}}{2h} &amp; - \frac{3M}{2h} \\       
0 &amp; 0 &amp; 1 &amp; -1 &amp;  - \frac{3M}{2h} &amp; - \frac{3L_{2}}{2h} \\
\end{bmatrix}
\begin{bmatrix}
V_{L_{1}}^{+} \\
V_{L_{1}}^{-} \\        
V_{L_{2}}^{+} \\        
V_{L_{2}}^{-} \\
I_{L_{1}} \\ 
I_{L_{2}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\ 
- \frac{2L_{1}}{h}\left(I_{L_{1}}\right)_{n-1} + \frac{L_{1}}{2h}\left(I_{L_{1}}\right)_{n-2}  - \frac{2M}{h}\left(I_{L_{2}}\right)_{n-1} + \frac{M}{2h}\left(I_{L_{2}}\right)_{n-2} \\ 
- \frac{2L_{2}}{h}\left(I_{L_{2}}\right)_{n-1} + \frac{L_{2}}{2h}\left(I_{L_{2}}\right)_{n-2}  - \frac{2M}{h}\left(I_{L_{1}}\right)_{n-1} + \frac{M}{2h}\left(I_{L_{1}}\right)_{n-2}
\end{bmatrix}
\]</div>
<p>The phase variant of this</p>
<div class="arithmatex">\[
\frac{\Phi_0}{2\pi}\frac{d\phi_{L_{1}}}{dt} = L_{1}\frac{di_{L_{1}}}{dt} + M\frac{di_{L_{2}}}{dt}
\]</div>
<div class="arithmatex">\[
\frac{\Phi_0}{2\pi}\frac{d\phi_{L_{2}}}{dt} =M\frac{di_{L_{1}}}{dt} + L_{2}\frac{di_{L_{2}}}{dt}
\]</div>
<p>With integration on both sides</p>
<div class="arithmatex">\[
\frac{\Phi_0}{2\pi}\phi_{L_{1}} = L_{1}I_{L_{1}} + MI_{L_{2}}
\]</div>
<div class="arithmatex">\[
\frac{\Phi_0}{2\pi}\phi_{L_{2}} = MI_{L_{1}} + L_{2}I_{L_{2}}
\]</div>
<p>This leads to a quite simplified component stamp matrix</p>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 0 \\       
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 \\
1 &amp; -1 &amp; 0 &amp; 0 &amp; -\frac{2\pi}{\Phi_0}L_{1} &amp; -\frac{2\pi}{\Phi_0}M \\       
0 &amp; 0 &amp; 1 &amp; -1 &amp; -\frac{2\pi}{\Phi_0}M &amp; -\frac{2\pi}{\Phi_0}L_{2} \\
\end{bmatrix}
\begin{bmatrix}
\phi_{L_{1}}^{+} \\
\phi_{L_{1}}^{-} \\     
\phi_{L_{2}}^{+} \\     
\phi_{L_{2}}^{-} \\
I_{L_{1}} \\ 
I_{L_{2}}
\end{bmatrix}
=
\begin{bmatrix}
0 \\
0 \\
0 \\
0 \\
0 \\ 
0
\end{bmatrix}
\]</div>
<h3 id="current-controlled-current-source">Current Controlled Current Source</h3>
<p><center><img src="../img/josim_cccs.svg" alt="Basic Current Controlled Current Source Element" style="width:400px;" /></center></p>
<p>Current controlled current source allows modulation of current in a particular branch through the current in a remote branch.</p>
<div class="arithmatex">\[
I_{out} = \beta I_{in}
\]</div>
<div class="arithmatex">\[
V_{1} - V_{2} = 0
\]</div>
<div class="arithmatex">\[
\beta = value
\]</div>
<div class="arithmatex">\[
\begin{bmatrix}
    0 &amp; 0 &amp; 0 &amp; 0 &amp; \frac{1}{\beta} \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; -\frac{1}{\beta} \\ 
    0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
    0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 \\
    1 &amp; -1 &amp; 0 &amp; 0 &amp; 0
    \end{bmatrix}
    \begin{bmatrix}
    V_{1}\\
    V_{2}\\
    V_{3}\\
    V_{4}\\
    I_{out}
    \end{bmatrix}
    =
    \begin{bmatrix}
    0\\
    0\\
    0\\
    0\\
    0
    \end{bmatrix}
\]</div>
<h3 id="current-controlled-voltage-source">Current Controlled Voltage Source</h3>
<p><center><img src="../img/josim_ccvs.svg" alt="Basic Current Controlled Voltage Source Element" style="width:400px;" /></center></p>
<p>Current controlled voltage source allows the modulation of a voltage node through a remote current.</p>
<div class="arithmatex">\[
V_{1} - V_{2} = 0
\]</div>
<div class="arithmatex">\[
V_{3} - V_{4} = \mu I_{in}
\]</div>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; -1\\
0 &amp; 0 &amp; 1 &amp; -1 &amp; -\mu &amp; 0\\
1 &amp; -1 &amp; 0 &amp; 0 &amp; 0 &amp; -\mu
\end{bmatrix}
\begin{bmatrix}
V_{1}\\
V_{2}\\
V_{3}\\
V_{4}\\
I_{in}\\
I_{out}\end{bmatrix}
=
\begin{bmatrix}
0\\
0\\
0\\
0\\
0\\
0
\end{bmatrix}
\]</div>
<h3 id="voltage-controlled-current-source">Voltage Controlled Current Source</h3>
<p><center><img src="../img/josim_vccs.svg" alt="Basic Voltage Controlled Current Source Element" style="width:400px;" /></center></p>
<p>Voltage controlled current source allows the modulation of a current in a branch through a remote voltage.</p>
<div class="arithmatex">\[
\alpha(V_{1} - V_{2}) = I_{out}
\]</div>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1\\
1 &amp; -1 &amp; 0 &amp; 0 &amp; -\frac{1}{\alpha}
\end{bmatrix}
\begin{bmatrix}
V_{1}\\
V_{2}\\
V_{3}\\
V_{4}\\
I_{in}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0\\
0\\
0\\
0
\end{bmatrix}
\]</div>
<h3 id="voltage-controlled-voltage-source">Voltage Controlled Voltage Source</h3>
<p><center><img src="../img/josim_vcvs.svg" alt="Basic Voltage Controlled Voltage Source Element" style="width:400px;" /></center></p>
<p>Voltage controlled current source allows the modulation of a current in a branch through a remote voltage.</p>
<div class="arithmatex">\[
A(V_{1} - V_{2}) = V_{3}-V_{4}
\]</div>
<div class="arithmatex">\[
\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; -1\\
G &amp; -G &amp; 1 &amp; -1 &amp; 0
\end{bmatrix}
\begin{bmatrix}
V_{1}\\
V_{2}\\
V_{3}\\
V_{4}\\
I_{out}
\end{bmatrix}
=
\begin{bmatrix}
0\\
0\\
0\\
0\\
0
\end{bmatrix}
\]</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>W. Haberkorn, H. Knauer and J. Richter, "A theoretical study of the current-phase relation in Josephson contacts" in <em>physica status solidi (a)</em>, vol. 47, no. 2, pp. K161-K164, 1978&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../ex_usage/" title="Example Usage" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Example Usage
              </div>
            </div>
          </a>
        
        
          <a href="../syntax/" title="Syntax Guide" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Syntax Guide
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2021 Johannes Delport
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/JoeyDelp" target="_blank" rel="noopener" title="JoeyDelp on GitHub" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.c6483021.min.js"></script>
      <script src="../assets/javascripts/bundle.e2f7d7a4.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: ['toc.integrate', 'header.autohide'],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.cbc634e2.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
      
        <script src="../javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>